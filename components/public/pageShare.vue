<template>
    <div class="">
        <el-dropdown>
            <div class="flex items-center">
                <div class="cuIcon-share" />
                <div class="ml-xs">分享</div>
            </div>
            <el-dropdown-menu slot="dropdown">
                <el-dropdown-item>
                    <a class="flex items-center" @click="copyUrl(urlData)">
                        <svg
                            t="1645512000921"
                            class="icon"
                            viewBox="0 0 1024 1024"
                            version="1.1"
                            xmlns="http://www.w3.org/2000/svg"
                            p-id="2917"
                            width="20"
                            height="20"
                        >
                            <path
                                d="M350.18271573333334 898.3387658666664c-56.63604906666666 0-113.27209919999997-22.249876266666657-155.749136-64.72691413333334-78.88592639999999-76.86320959999999-86.9767904-202.27160533333333-18.204443733333335-287.2256789333333l8.090864-10.113579733333331 2.0227157333333334-2.0227167999999995 364.08888959999996-360.04345599999994c64.72691306666665-62.70419733333333 167.8854325333333-62.70419733333333 232.6123455999999 0 30.340740266666668 30.340740266666668 48.54518506666666 70.79506133333331 48.54518506666666 115.29481386666663s-16.181728 84.95407359999997-48.54518506666666 115.29481493333331L427.0459264 756.7486421333333c-42.477036799999986 42.477036799999986-111.2493824 42.477036799999986-153.72642026666662 0-20.22716053333333-20.22716053333333-32.36345706666667-46.522469333333326-32.36345706666667-76.86320959999999 0-28.31802453333333 12.136296533333333-56.63604906666666 32.36345706666667-76.86321066666666L572.6814816 307.70567893333333c8.090864-8.090864 20.22716053333333-8.090864 28.31802453333333 0 8.090864 8.090864 8.090864 20.22716053333333 0 28.31802453333333L301.63753066666663 633.3629632c-12.136296533333333 12.136296533333333-20.22716053333333 30.340740266666668-20.22716053333333 46.522469333333326s6.068148266666666 34.38617279999999 20.22716053333333 46.52246826666668c26.2953088 26.2953088 70.79506133333331 26.2953088 97.09037013333332 0L754.7259263999999 374.45530880000007c24.272593066666666-22.249876266666657 36.40888853333332-54.61333333333334 36.40888853333332-86.9767904s-12.136296533333333-62.70419733333333-36.40888853333332-86.9767904c-48.54518506666666-48.54518506666666-127.43111146666665-48.54518506666666-175.97629653333334 0L216.68345706666673 560.5451850666666l-8.090864 10.113580799999996c-54.61333333333334 70.79506133333331-48.54518506666666 171.930864 14.159012266666664 234.63506133333334 64.72691306666665 62.70419733333333 165.86271573333332 68.77234559999998 238.6804938666666 14.159012266666664l10.113579733333331-8.090864L855.8617279999999 431.0913578666666c8.090864-8.090864 20.22716053333333-8.090864 28.3180256 0 8.090864 8.090864 8.090864 20.22716053333333 0 28.31802453333333l-384.31605013333325 382.29333333333324-2.0227157333333334 2.0227167999999995-10.113580799999996 8.090864c-42.477036799999986 30.340740266666668-88.99950613333333 46.522469333333326-137.54469119999996 46.522469333333326z"
                                fill=""
                                p-id="2918"
                            />
                        </svg>
                        <div class="ml-xs">复制链接</div>
                    </a>
                </el-dropdown-item>
                <el-dropdown-item>
                    <a target="_blank" :href="weiboUrl" class="flex items-center">
                        <svg
                            t="1645511879806"
                            class="icon"
                            viewBox="0 0 1024 1024"
                            version="1.1"
                            xmlns="http://www.w3.org/2000/svg"
                            p-id="2072"
                            width="20"
                            height="20"
                        >
                            <path
                                d="M851.4 590.193c-22.196-66.233-90.385-90.422-105.912-91.863-15.523-1.442-29.593-9.94-19.295-27.505 10.302-17.566 29.304-68.684-7.248-104.681-36.564-36.14-116.512-22.462-173.094 0.866-56.434 23.327-53.39 7.055-51.65-8.925 1.89-16.848 32.355-111.02-60.791-122.395C311.395 220.86 154.85 370.754 99.572 457.15 16 587.607 29.208 675.873 29.208 675.873h0.58c10.009 121.819 190.787 218.869 412.328 218.869 190.5 0 350.961-71.853 398.402-169.478 0 0 0.143-0.433 0.575-1.156 4.938-10.506 8.71-21.168 11.035-32.254 6.668-26.205 11.755-64.215-0.728-101.66z m-436.7 251.27c-157.71 0-285.674-84.095-285.674-187.768 0-103.671 127.82-187.76 285.674-187.76 157.705 0 285.673 84.089 285.673 187.76 0 103.815-127.968 187.768-285.673 187.768z"
                                fill="#E71F19"
                                p-id="2073"
                            />
                            <path
                                d="M803.096 425.327c2.896 1.298 5.945 1.869 8.994 1.869 8.993 0 17.7-5.328 21.323-14.112 5.95-13.964 8.993-28.793 8.993-44.205 0-62.488-51.208-113.321-114.181-113.321-15.379 0-30.32 3.022-44.396 8.926-11.755 4.896-17.263 18.432-12.335 30.24 4.933 11.662 18.572 17.134 30.465 12.238 8.419-3.46 17.268-5.33 26.41-5.33 37.431 0 67.752 30.241 67.752 67.247 0 9.068-1.735 17.857-5.369 26.202a22.832 22.832 0 0 0 12.335 30.236l0.01 0.01z"
                                fill="#F5AA15"
                                p-id="2074"
                            />
                            <path
                                d="M726.922 114.157c-25.969 0-51.65 3.744-76.315 10.942-18.423 5.472-28.868 24.622-23.5 42.91 5.509 18.29 24.804 28.657 43.237 23.329a201.888 201.888 0 0 1 56.578-8.064c109.253 0 198.189 88.271 198.189 196.696 0 19.436-2.905 38.729-8.419 57.16-5.508 18.289 4.79 37.588 23.212 43.053 3.342 1.014 6.817 1.442 10.159 1.442 14.943 0 28.725-9.648 33.37-24.48 7.547-24.906 11.462-50.826 11.462-77.175-0.143-146.588-120.278-265.813-267.973-265.813z"
                                fill="#F5AA15"
                                p-id="2075"
                            />
                            <path
                                d="M388.294 534.47c-84.151 0-152.34 59.178-152.34 132.334 0 73.141 68.189 132.328 152.34 132.328 84.148 0 152.337-59.182 152.337-132.328 0-73.15-68.19-132.334-152.337-132.334zM338.53 752.763c-29.454 0-53.39-23.755-53.39-52.987 0-29.228 23.941-52.989 53.39-52.989 29.453 0 53.39 23.76 53.39 52.989 0 29.227-23.937 52.987-53.39 52.987z m99.82-95.465c-6.382 11.086-19.296 15.696-28.726 10.219-9.43-5.323-11.75-18.717-5.37-29.803 6.386-11.09 19.297-15.7 28.725-10.224 9.43 5.472 11.755 18.864 5.37 29.808z"
                                fill="#040000"
                                p-id="2076"
                            />
                        </svg>
                        <div class="ml-xs">微博分享</div>
                    </a>
                </el-dropdown-item>
                <el-dropdown-item disabled>
                    <div class="flex items-center">
                        <svg
                            t="1645512083995"
                            class="icon"
                            viewBox="0 0 1024 1024"
                            version="1.1"
                            xmlns="http://www.w3.org/2000/svg"
                            p-id="6684"
                            width="20"
                            height="20"
                        >
                            <path
                                d="M1010.8 628c0-141.2-141.3-256.2-299.9-256.2-168 0-300.3 115.1-300.3 256.2 0 141.4 132.3 256.2 300.3 256.2 35.2 0 70.7-8.9 106-17.7l96.8 53-26.6-88.2c70.9-53.2 123.7-123.7 123.7-203.3zM618 588.8c-22.1 0-40-17.9-40-40s17.9-40 40-40 40 17.9 40 40c0 22-17.9 40-40 40z m194.3-0.3c-22.1 0-40-17.9-40-40s17.9-40 40-40 40 17.9 40 40-17.9 40-40 40z"
                                fill="#00C800"
                                p-id="6685"
                            />
                            <path
                                d="M366.3 106.9c-194.1 0-353.1 132.3-353.1 300.3 0 97 52.9 176.6 141.3 238.4l-35.3 106.2 123.4-61.9c44.2 8.7 79.6 17.7 123.7 17.7 11.1 0 22.1-0.5 33-1.4-6.9-23.6-10.9-48.3-10.9-74 0-154.3 132.5-279.5 300.2-279.5 11.5 0 22.8 0.8 34 2.1C692 212.6 539.9 106.9 366.3 106.9zM247.7 349.2c-26.5 0-48-21.5-48-48s21.5-48 48-48 48 21.5 48 48-21.5 48-48 48z m246.6 0c-26.5 0-48-21.5-48-48s21.5-48 48-48 48 21.5 48 48-21.5 48-48 48z"
                                fill="#00C800"
                                p-id="6686"
                            />
                        </svg>
                        <div class="ml-xs">微信扫一扫</div>
                    </div>
                    <div class="">
                        <div ref="qrCodeUrl" class="qrcode" />
                    </div>
                </el-dropdown-item>
            </el-dropdown-menu>
        </el-dropdown>
    </div>
</template>

<script>
if (process.browser) {
    // 在这里根据环境引入wow.js
    const QRCode = require('qrcodejs2')
}

export default {
    props: {
        urlData: {
            type: String,
            default: '',
        },
    },
    data() {
        return {
            weiboUrl: '',
            urlDatas: '',
        }
    },
    mounted() {
        this.$nextTick(() => {
            this.urlDatas = this.urlData || window.location.href
            this.weiboUrl = `https://service.weibo.com/share/share.php?appKey=3063806388&title=${encodeURIComponent(this.urlDatas)}`

            this.creatQrCode()
        })
    },
    methods: {
        copyUrl(value) {
            const oInput = document.createElement('input')
            oInput.value = value
            document.body.appendChild(oInput)
            oInput.select() // 选择对象
            document.execCommand('Copy') // 执行浏览器复制命令
            oInput.className = 'oInput'
            oInput.style.display = 'none'

            this.$message({
                message: '分享链接复制成功',
                type: 'success',
            })
        },
        creatQrCode() {
            // eslint-disable-next-line no-new
            new QRCode(this.$refs.qrCodeUrl, {
                text: this.urlDatas, // 需要转换为二维码的内容
                width: 100,
                height: 100,
                colorDark: '#000000',
                colorLight: '#ffffff',
                correctLevel: QRCode.CorrectLevel.H,
            })
        },
    },
}
</script>

<style lang="less">
.qrcode {
    display: inline-block;

    img {
        width: 100px;
        height: 100px;
        border: 1px solid #efefef;
        background-color: #fff; //设置白色背景色
        padding: 6px; // 利用padding的特性，挤出白边
        box-sizing: border-box;
    }
}
</style>
